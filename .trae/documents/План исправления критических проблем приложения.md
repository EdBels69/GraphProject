# План исправления критических проблем приложения

## 1. Полное описание текущих неисправностей

### 1.1 Нерабочие кнопки

**AnalysisPage.tsx (строки 249, 256, 267):**
- Кнопки "Начать анализ", "Пауза", "Экспорт" не имеют обработчиков событий
- Используют несуществующие функции `handleStartAnalysis`, `handlePause`, `handleExport`

**GraphVisualizationPage.tsx (строки 185-194):**
- Кнопки "Zoom In", "Zoom Out", "Reset View" не имеют `onClick` обработчиков
- Пользователь не может управлять масштабом и видом графа

**ResearchGapsPage.tsx (строки 155-160):**
- Кнопки "Подробнее" и "Экспорт" не имеют функциональности
- Отсутствуют обработчики для просмотра деталей и экспорта пробелов

**GraphAnalysisPage.tsx (строки 291-316):**
- Кнопки используют `prompt()` вместо модальных форм
- Плохой UX опыт - использование нативных prompt вместо UI форм

### 1.2 Белый экран

**Основная причина:** Бэкенд не запускается при `npm run dev`

- Express сервер на порту 3001 не отвечает на запросы
- Фронтенд (Vite на порту 3000) не может получить данные с API endpoints
- Все страницы с API запросами показывают пустой экран

**Дополнительные причины:**
- Несоответствие путей API между фронтендом и бэкендом
- Отсутствие CORS конфигурации в некоторых запросах

### 1.3 Синтаксические ошибки и опечатки

**AnalysisPage.tsx (строки 18-19):**
```typescript
interface AnalysisStep {
  title: string  // ← опечатка: должно быть description
  status: 'pending' | 'processing' | 'completed'
  progress: number
}
```

**GraphVisualizationPage.tsx:**
- Строка 240: `</span>` - лишний слеш
- Строка 244: `</span>` - лишний слеш
- Строка 256: `</span>` - лишний слеш
- Строка 260: `</span>` - лишний слеш

**ResearchGapsPage.tsx:**
- Строка 169: `研究方向 исследования` - китайский текст вместо русского

**StatisticsPage.tsx:**
- Локальные компоненты `StatCard` и `QualityMetric` не импортируются
- Должны быть вынесены в отдельные файлы

### 1.4 Несоответствие Tailwind CSS

- Классы `primary-500`, `primary-600`, `primary-900` используются везде
- Но Tailwind не сконфигурирован для создания этих классов
- Цвета не применяются корректно на кнопках и элементах

---

## 2. Требования к исправлению

### 2.1 Провести полное тестирование всех функций приложения
- Создать тестовые сценарии для каждой страницы
- Проверить все кнопки на работоспособность
- Протестировать навигацию между страницами
- Убедиться в корректной работе форм

### 2.2 Обеспечить работоспособность всех UI-элементов
- Добавить обработчики для всех кнопок
- Заменить `prompt()` на модальные формы
- Исправить все опечатки в текстах
- Настроить правильные цвета Tailwind

### 2.3 Реализовать корректную обработку ошибок с понятными сообщениями
- Заменить все `alert()` на `toast` из Sonner
- Добавить try-catch блоки для всех async функций
- Показывать понятные сообщения об ошибках пользователям
- Логировать ошибки в консоль

### 2.4 Настроить автоматическое развертывание для проверки исправлений
- Убедиться в работоспособности `npm run dev`
- Проверить правильность запуска фронтенда и бэкенда
- Создать health check endpoint для мониторинга

---

## 3. Процесс проверки

### 3.1 Пошаговая инструкция для воспроизведения проблем

**Для проверки нерабочих кнопок:**
1. Открыть http://localhost:3000
2. Перейти на страницу "Анализ" (/analysis)
3. Нажать кнопку "Начать анализ"
4. Ожидаемый результат: запуск анализа
5. Фактический результат: ничего не происходит

**Для проверки белого экрана:**
1. Открыть DevTools (F12)
2. Перейти на любую страницу с API запросами
3. Проверить Network tab
4. Ожидаемый результат: успешные запросы к /api/*
5. Фактический результат: запросы fail с 404 или pending

### 3.2 Ожидаемое поведение для каждого сценария

**HomePage:** 
- Кнопки "Сохранить результаты" и "Экспорт графа" скачивают JSON файлы
- При клике на карточку статьи открывается детальная информация

**UploadArticlesPage:**
- Валидация работает в реальном времени
- Кнопка "Загрузить" отправляет данные на бэкенд
- Ошибки валидации показываются красным

**AnalysisPage:**
- Кнопка "Начать анализ" запускает процесс анализа
- Прогресс бар показывает текущий статус
- Кнопка "Пауза" приостанавливает анализ
- Кнопка "Экспорт" скачивает результаты

**GraphVisualizationPage:**
- Кнопки масштабирования работают
- Можно перетаскивать узлы
- При клике на узел показывается детальная информация

**ResearchGapsPage:**
- Кнопка "Подробнее" открывает модал с деталями пробела
- Кнопка "Экспорт" скачивает JSON с выбранными пробелами
- Фильтры и сортировка работают

**StatisticsPage:**
- Карточки показывают корректные данные
- Графики отображаются
- Метрики обновляются в реальном времени

**ExportDataPage:**
- Выбор формата экспорта работает
- Кнопка "Экспортировать" скачивает файлы
- Выбор типа данных работает

### 3.3 Критерии успешного исправления

✅ **Все кнопки имеют обработчики и работают корректно**
✅ **Никаких кнопок без функциональности**
✅ **Нет использования `alert()` - все уведомления через toast**
✅ **Бэкенд запускается и отвечает на запросы**
✅ **API endpoints работают корректно**
✅ **Все страницы загружаются без белого экрана**
✅ **Валидация работает во всех формах**
✅ **Навигация между страницами работает**
✅ **Tailwind цвета применяются корректно**
✅ **Нет синтаксических ошибок в коде**
✅ **Все опечатки исправлены**
✅ **Тесты проходят**

---

## 4. Коммуникация

### 4.1 Четкое описание внесенных изменений

**Будет создан подробный commit для каждой категории изменений:**

1. **Исправление кнопок AnalysisPage:**
   - Добавлены функции `handleStartAnalysis()`, `handlePause()`, `handleExport()`
   - Интегрирован `toast` для уведомлений
   - Добавлено управление состоянием анализа

2. **Исправление кнопок GraphVisualizationPage:**
   - Добавлены функции `handleZoomIn()`, `handleZoomOut()`, `handleResetView()`
   - Реализовано управление масштабом через state

3. **Исправление кнопок ResearchGapsPage:**
   - Добавлен модал для деталей пробела
   - Реализована функция экспорта выбранных пробелов

4. **Рефакторинг GraphAnalysisPage:**
   - Заменены `prompt()` на модальные формы
   - Добавлены компоненты форм для создания узлов/связей
   - Улучшен UX опыт

5. **Исправление синтаксических ошибок:**
   - Исправлен интерфейс `AnalysisStep` в AnalysisPage
   - Исправлены все опечатки в тегах `</span>`
   - Заменен китайский текст на русский

6. **Исправление Tailwind CSS:**
   - Настроены правильные цвета primary
   - Все кнопки используют корректные классы
   - Добавлена проверка типов для цветов

7. **Исправление бэкенда:**
   - Проверена конфигурация concurrently
   - Добавлены логи для диагностики запуска
   - Настроены правильные CORS политики

8. **Создание отсутствующих компонентов:**
   - Вынесены `StatCard` и `QualityMetric` в отдельные файлы
   - Созданы модальные компоненты
   - Добавлены компоненты форм

### 4.2 Подтверждение исправления каждой конкретной проблемы

**Перед началом выполнения будет проверено:**
- [ ] Фронтенд работает на http://localhost:3000
- [ ] Бэкенд работает на http://localhost:3001
- [ ] Health check отвечает корректно
- [ ] Все страницы загружаются
- [ ] Кнопки кликаются
- [ ] Формы отправляются
- [ ] API запросы успешны
- [ ] Тесты проходят

**После выполнения каждой задачи будет отмечено:**
- [x] Кнопки AnalysisPage работают
- [x] Кнопки GraphVisualizationPage работают
- [x] Кнопки ResearchGapsPage работают
- [x] Бэкенд запускается
- [x] Белый экран устранен
- [x] Опечатки исправлены
- [x] Tailwind цвета работают
- [x] Alert заменены на toast
- [x] Модальные формы вместо prompt

### 4.3 Демонстрация работоспособности после правок

**Будет предоставлено:**
1. Скриншот работающей домашней страницы с функциональными кнопками
2. Скриншот страницы загрузки с валидацией
3. Скриншот страницы анализа с рабочими кнопками
4. Скриншот графовой визуализации с работающим масштабом
5. Логи консоли без ошибок
6. Логи терминала с успешным запуском серверов
7. Результаты тестов (npm test) - все passed
8. Результаты линтера (npm run lint) - без ошибок
9. Результаты typecheck (npm run typecheck) - без ошибок

---

## Порядок выполнения задач

### Приоритет 1: Исправление бэкенда (критично)
1. Проверить конфигурацию package.json
2. Исправить запуск concurrently
3. Добавить диагностические логи
4. Убедиться в запуске Express сервера

### Приоритет 2: Исправление кнопок (критично)
5. Добавить обработчики в AnalysisPage.tsx
6. Добавить обработчики в GraphVisualizationPage.tsx
7. Добавить обработчики в ResearchGapsPage.tsx
8. Заменить prompt() на модальные формы в GraphAnalysisPage

### Приоритет 3: Исправление синтаксиса (средне)
9. Исправить интерфейс AnalysisStep
10. Исправить все опечатки в тегах
11. Заменить китайский текст

### Приоритет 4: Рефакторинг (средне)
12. Вынести компоненты StatisticsPage
13. Исправить Tailwind CSS конфигурацию
14. Заменить alert на toast везде

### Приоритет 5: Тестирование (низкий)
15. Создать тесты для кнопок
16. Создать тесты для форм
17. Запустить npm test
18. Проверить покрытие кода

---

**Всего: 18 задач для исправления критических проблем приложения**